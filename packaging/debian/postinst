#!/bin/bash

# Create hiveden user if not exists
if ! id -u hiveden >/dev/null 2>&1; then
    useradd -r -s /usr/sbin/nologin -d /opt/hiveden -c "Hiveden Service User" hiveden
fi

# Set ownership of application directory
chown -R hiveden:hiveden /opt/hiveden
chmod 750 /opt/hiveden

# Install all Python dependencies via pip
pip3 install --no-warn-script-location click fastapi uvicorn docker PyYAML psutil lxc paramiko websockets pihole6api yoyo-migrations python-multipart 2>/dev/null || true
